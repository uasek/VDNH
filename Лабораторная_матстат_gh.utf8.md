---
title: "–ò–¥–µ–∏ –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π –ø–æ –º–∞—Ç—Å—Ç–∞—Ç—É"
author: "–ú–∏—Ö–∞–∏–ª –ë–∞—Ä–∞–Ω–æ–≤"
output:
  rmarkdown::github_document:
    pandoc_args: --webtex
    
#  html_document:
#    highlight: pygments
---
–ò–¥–µ–∏ –¥–ª—è –∑–∞–¥–∞—á –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π –ø–æ –º–∞—Ç—Å—Ç–∞—Ç—É –≤ R.


```r
library(ggplot2)
library(emo) # emoji
library(knitr) # –¥–ª—è –º–µ–º–∞ –∏ —Ç–∞–±–ª–∏—á–∫–∏ –≤ 3 –∑–∞–¥–∞—á–µ
set.seed(3141593) # –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

# –ó–∞–¥–∞—á–∞ 1. –ú–µ—Ç–æ–¥ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ $\pi$

–û–¥–Ω–æ –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞–µ—Ç —Å—Ä–µ–¥–∞ R (–∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è) –ø—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—É–∫–≤–∞–ª—å–Ω–æ "–ø–æ—á—É—Å—Ç–≤–æ–≤–∞—Ç—å" –ø—Ä–µ–¥–º–µ—Ç –∏–∑—É—á–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ *–ø—Å–µ–≤–¥–æ*—Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω.

–ü—Ä–∏—Å—Ç–∞–≤–∫–∞ "–ø—Å–µ–≤–¥–æ" —Ç—É—Ç —Å—Ç–æ–∏—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫: –∞–ª–≥–æ—Ä–∏—Ç–º—ã R, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–µ —ç—Ç–∏ —á–∏—Å–ª–∞, –∞–±—Å–æ–ª—é—Ç–Ω–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –æ–¥–Ω–∞–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –ø–æ–ª—É—á–∞–µ–º—ã—Ö —á–∏—Å–µ–ª –Ω–µ–æ—Ç–ª–∏—á–∏–º—ã –æ—Ç "–Ω–∞—Å—Ç–æ—è—â–∏—Ö" —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω. –û—Å—Ç–∞–≤–∏–º —ç—Ç–æ—Ç –ø–æ—á—Ç–∏ —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å –∏ –¥–≤–∏–Ω–µ–º—Å—è –¥–∞–ª—å—à–µüòâ.

–ò—Ç–∞–∫, –ø—É—Å—Ç—å –º—ã –≤—ã–±–∏—Ä–∞–µ–º –Ω–∞—É–¥–∞—á—É —Ç–æ—á–∫—É –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π $2$. –°–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ $X$ —Ä–∞–≤–Ω–∞ –µ–¥–∏–Ω–∏—Ü–µ, –µ—Å–ª–∏ —ç—Ç–∞ —Ç–æ—á–∫–∞ –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∫—Ä—É–≥–∞, –≤–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤ —ç—Ç–æ—Ç –∫–≤–∞–¥—Ä–∞—Ç, –∏ –Ω—É–ª—é –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ:


```r
x = c(-1, -1, 1, 1)
y = c(-1, 1, 1, -1)
z <- seq(0, 2 * pi, length.out = 100)
```


```r
ggplot() + 
  geom_polygon(aes(x, y), fill = NA, color = 'black') + 
  coord_fixed() + theme_classic() + 
  geom_vline(xintercept = 0, linetype = 'dashed') + 
  geom_hline(yintercept = 0, linetype = 'dashed') +
  geom_path(aes(cos(z), sin(z)), color = 'royalblue') +
  geom_point(aes(c(-0.314, 0.8), c(-0.271, 0.7)), color = c('seagreen', 'red')) + 
  geom_text(aes(-0.314, -0.2, label = 'X = 1'), size = 5, color = 'seagreen') +
  geom_text(aes(0.8, 0.77, label = 'X = 0'), size = 5, color = 'red')
```

![](–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_–º–∞—Ç—Å—Ç–∞—Ç_gh_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

–ù–µ—Ç—Ä—É–¥–Ω–æ –≤–∏–¥–µ—Ç—å, —á—Ç–æ —Å –ø–æ–º–æ—â—å—é –ø–ª–æ—â–∞–¥–∏ –∫—Ä—É–≥–∞ $S_0$ –∏ –ø–ª–æ—â–∞–¥–∏ –∫–≤–∞–¥—Ä–∞—Ç–∞ $S_1$ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å $\mathbb{P}(X=1)=\frac{S_{0}}{S_{1}}=\frac{\pi}{4}$

–ï—Å–ª–∏ –∂–µ –º—ã –≤—ã–±–µ—Ä–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ —Ç–æ—á–µ–∫ –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∞, —Ç–æ –¥–æ–ª—è –ø–æ–ø–∞–≤—à–∏—Ö –≤ –∫—Ä—É–≥ —Ç–æ—á–µ–∫ –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ–º (–æ—Ü–µ–Ω–∫–æ–π) –∏—Å–∫–æ–º–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏!


```r
X <- runif(1e3, -1, 1)
Y <- runif(1e3, -1, 1)
in_circle <- (X ^ 2 + Y ^ 2) < 1
```


```r
ggplot() + 
  geom_polygon(aes(x, y), fill = NA, color = 'black') + 
  coord_fixed() + theme_classic() + 
  geom_vline(xintercept = 0, linetype = 'dashed') + 
  geom_hline(yintercept = 0, linetype = 'dashed') +
  geom_path(aes(cos(z), sin(z)), color = 'royalblue') +
  geom_point(aes(X[in_circle], Y[in_circle]), color = 'seagreen') +
  geom_point(aes(X[!in_circle], Y[!in_circle]), color = 'red')
```

![](–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_–º–∞—Ç—Å—Ç–∞—Ç_gh_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é $10000$ (–ø—Å–µ–≤–¥–æ)—Å–ª—É—á–∞–π–Ω—ã—Ö —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ $[-1, 1]$ –≤–µ–ª–∏—á–∏–Ω –¥–ª—è x-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –¥–ª—è y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.


```r
X <- runif(n = 1e4, min = -1, max = 1)
Y <- runif(1e4, -1, 1)
```

–î–ª—è —ç—Ç–æ–≥–æ –º—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–µ–π `runif`, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–µ–π –≤—ã–±–æ—Ä–∫—É –∏–∑ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫ –Ω–µ–π –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏, –∫–∞–∫ –≤—ã—á–∏—Å–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –∫–≤–∞–Ω—Ç–∏–ª–∏. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∫ –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø–µ—Ä–µ–¥ –µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º: `?runif`

–ò –≤–æ–æ–±—â–µ:


```r
knitr::include_graphics('meme.png')
```

<img src="meme.png" width="400px" />

–ß–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é!

–¢–æ—á–∫–∞ –ª–µ–∂–∏—Ç –≤ –∫—Ä—É–≥–µ, –µ—Å–ª–∏ —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –µ–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –º–µ–Ω—å—à–µ –µ–¥–∏–Ω–∏—Ü—ã. –ù–æ –∫–∞–∫ –Ω–∞–º —ç—Ç–æ –±—ã—Å—Ç—Ä–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –¥–ª—è 10000 —Ç–æ—á–µ–∫? –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —Ç–µ–º –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ—á–∫–∏ –∫–æ–¥–∞:


```r
c(1, 2, 3, 4, 5) > 3
```

```
## [1] FALSE FALSE FALSE  TRUE  TRUE
```

–û–ø–µ—Ä–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –±—ã–ª–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –¥–ª—è *–∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞* –≤–µ–∫—Ç–æ—Ä–∞, –∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤–µ–∫—Ç–æ—Ä —Ç–∞–∫–æ–π –∂–µ –¥–ª–∏–Ω—ã. 

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã, –±—É–¥—É—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π *–ø–∞—Ä—ã* —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å (–ø–∞—Ä—ã –ø–µ—Ä–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ø–∞—Ä—ã –≤—Ç–æ—Ä—ã—Ö –∏ —Ç.–¥.)


```r
a <- c(1, 2, 3, 4)
b <- c(2, 2, 2, 2)
b ^ a
```

```
## [1]  2  4  8 16
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º –±—ã—Å—Ç—Ä–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å, –∫–∞–∫–∏–µ —Ç–æ—á–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫—Ä—É–≥–µ, —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏, –∞ –∑–∞—Ç–µ–º —Å—Ä–∞–≤–Ω–∏–≤ –µ–≥–æ —Å –µ–¥–∏–Ω–∏—Ü–µ–π:


```r
distance <- X ^ 2 + Y ^ 2
distance[1:5]
```

```
## [1] 0.1242660 0.8413127 0.8745991 0.8742188 0.3355467
```


```r
in_circle <- distance < 1
in_circle[1:5]
```

```
## [1] TRUE TRUE TRUE TRUE TRUE
```

–ó–Ω–∞—á–µ–Ω–∏–µ `TRUE` –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º –æ —Ç–æ–º, —á—Ç–æ —Å–ª—É—á–∞–π–Ω–∞—è —Ç–æ—á–∫–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –≤–Ω—É—Ç—Ä–∏ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏. –î–æ–ª—è —Ç–∞–∫–∏—Ö —Ç–æ—á–µ–∫ - –æ—Ü–µ–Ω–∫–∞ –∏—Å–∫–æ–º–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –∞ –∏–º–µ–Ω–Ω–æ $\frac{\pi}{4}$


```r
mean(in_circle)
```

```
## [1] 0.7844
```

–†–∞—Å—á–∏—Ç–∞–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ü–µ–Ω–∫—É –¥–ª—è $\pi$


```r
4 * mean(in_circle)
```

```
## [1] 3.1376
```


```r
pi
```

```
## [1] 3.141593
```

–û–ø–∏—Å–∞–Ω–Ω–∞—è –≤—ã—à–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–º–µ—Ç–æ–¥ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ**: –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω. 

–í –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω –Ω–µ —Ç–∞–∫ –ø–æ–ª–µ–∑–µ–Ω –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏. –ß—Ç–æ–±—ã –≤ —ç—Ç–æ–º —É–±–µ–¥–∏—Ç—å—Å—è, –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å $\pi$ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤—ã–±–æ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ $10^6$ –∏–ª–∏ –¥–∞–∂–µ $10^7$. –ü–æ–ª—É—á–∏—Ç—Å—è –ª–∏ –ø–æ–ª—É—á–∏—Ç—å —Ö–æ—Ç—è –±—ã —Ç—Ä–∏ –≤–µ—Ä–Ω—ã—Ö –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π?

–û–¥–Ω–∞–∫–æ –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º —Å–ª—É—á–∞–µ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ - –∑–∞—á–∞—Å—Ç—É—é –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥, –ø–æ—Å–∫–æ–ª—å–∫—É –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—ã—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ–±—ä–µ–º–æ–≤ —Ç–µ–ª —Ä–∞—Å—Ç–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏.

## –ó–∞–¥–∞–Ω–∏–µ.

–ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –º–µ—Ç–æ–¥–æ–º –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $\ln(2)$. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ $10000$ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–æ—á–∫–µ–∫, –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–∑ –∫–≤–∞—Ä–¥—Ä–∞—Ç–∞ —Å –≤–µ—Ä—à–∏–Ω–∞–º–∏ $(1, 0),\;(1, 1),\; (2, 0),\; (2, 1)$. –ü–æ–ø–∞–¥–∞–Ω–∏–µ –ø–æ–¥ –≥—Ä–∞—Ñ–∏–∫ –∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å? 

# –ó–∞–¥–∞—á–∞ 2. –ú–µ—Ç–æ–¥ –æ–±—Ä–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

–ü—Ä–æ–¥–æ–ª–∂–∏–º —Ä–∞–±–æ—Ç—É —Å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏. –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ —Å –∏—Ö –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é. –°—Ä–∞–∑—É –æ–±—Ä–∞—Ç–∏–º—Å—è –∫ –ø—Ä–∏–º–µ—Ä—É.

–ü—É—Å—Ç—å $Y \sim U([0, 1])$. –ö–∞–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å $-\ln(Y)$? 

–î–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ (–≤ —Å–∏–ª—É —Å–∏–º–º–µ—Ç—Ä–∏–∏) $1 - Y$ –∏–º–µ–µ—Ç —Ç–∞–∫–æ–µ –∂–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –∫–∞–∫ –∏ $Y$. –ë—É–¥–µ–º –∏—Å–∫–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ $-\ln(1-Y)$. 

–û—Å—Ç–∞–µ—Ç—Å—è –ª–∏—à—å –≤—ã–≤–µ—Å—Ç–∏, —á—Ç–æ $$\mathbb{P}(-\ln(1-Y) < x) = \mathbb{P}(Y < 1 - e^{-x})$$

–°–ø—Ä–∞–≤–∞ –ø–æ–ª—É—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è $Y$ –≤ —Ç–æ—á–∫–µ $1 - e ^ {-x}$. –¢.–∫. $F(x) = x$, $$F(1 - e^{-x}) = 1 - e^{-x}$$

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, $-\ln(1-Y)$, –∞ –∑–Ω–∞—á–∏—Ç –∏ $-\ln(Y)$, –∏–º–µ–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ!

–£–±–µ–¥–∏–º—Å—è –≤ —ç—Ç–æ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–∏–º—É–ª—è—Ü–∏–∏:


```r
y <- runif(1e4, 0, 1)
log_y <- -log(y)
```

–ü–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –Ω–µ–µ:


```r
t <- seq(0, 10, length.out = 100) # —Ç–æ—á–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
```


```r
ggplot() + theme_classic() +
  
  geom_histogram(mapping = aes(x = log_y, y = ..density..), # —á—Ç–æ–±—ã –ø–ª–æ—â–∞–¥—å –ø–æ–¥ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–æ–π —Å—É–º–º–∏—Ä–æ–≤–∞–ª–∞—Å—å –≤ –µ–¥–∏–Ω–∏—Ü—É
                          bins = 50, color = 'black', fill = 'seagreen') + 
  
  geom_line(mapping = aes(x = t, y = dexp(t, rate = 1)), 
            color = 'red', size = 1.1, alpha = 0.6)
```

![](–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_–º–∞—Ç—Å—Ç–∞—Ç_gh_files/figure-gfm/unnamed-chunk-17-1.png)<!-- -->

–ò—Ç–∞–∫, –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –¥–æ–∫–∞–∑–∞—Ç—å.

–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ $U$ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è $F(x)$, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∏—Ä–∞–≤–Ω—è—Ç—å $Y = F(x)$ –∏ –≤—ã—Ä–∞–∑–∏—Ç—å $x = F^{-1}(Y)$. –¢–æ–≥–¥–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–ø—Ä–∞–≤–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç $Y$ - –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–∫–æ–µ –∂–µ, –∫–∞–∫ –∏ $U$. 

–ü—Ä–æ–±–ª–µ–º—ã –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ª–∏—à—å –≤ —Ç–æ—á–∫–∞—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö $F^{-1}(x)$ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–ª—É—á–∞–µ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω). –¢–æ–≥–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –≤ –∫–∞–∂–¥–æ–π –∏–∑ —Ç–∞–∫–∏—Ö —Ç–æ—á–µ–∫.

## –ó–∞–¥–∞–Ω–∏–µ.

–°–æ–∑–¥–∞–π—Ç–µ *–Ω–æ—Ä–º–∞–ª—å–Ω—É—é* –≤—ã–±–æ—Ä–∫—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω. –ö–∞–∫ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –æ–±—Ä–∞—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (**quantile function**)? –û—Ç–≤–µ—Ç –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —á—Ç–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫ —Ñ—É–Ω–∫—Ü–∏–∏ `dexp()` –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –≤—ã—à–µ üòã

–î–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É —Å –≥—Ä–∞—Ñ–∏–∫–æ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏.

# –ó–∞–¥–∞—á–∞ 3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–¥–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π.

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–∫–∞—Ö –æ–±–ª–∞—Å—Ç–∏ —é–∂–Ω–æ–≥–æ –õ–æ–Ω–¥–æ–Ω–∞ –≤–æ –≤—Ä–µ–º—è –í—Ç–æ—Ä–æ–π –º–∏—Ä–æ–≤–æ–π –≤–æ–π–Ω—ã *(–∏—Å—Ç–æ—á–Ω–∏–∫: R.D. Clarke. An application of the Poisson distribution. Journal of
the Institute of Actuaries, 72:48, 1946; Table 1 on page 481. Faculty and Institute of Actuaries.)*. –≠—Ç–∞ –æ–±–ª–∞—Å—Ç—å –±—ã–ª–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ $576$ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π $250$ –º–µ—Ç—Ä–æ–≤, –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∞ –±—ã–ª–æ –ø–æ–¥—Å—á–∏—Ç–∞–Ω–æ —á–∏—Å–ª–æ –ø–æ–ø–∞–≤—à–∏—Ö —Ç—É–¥–∞ –±–æ–º–±.


```r
number_of_hits <- 0:7
number_of_squares <- c(229, 211, 93, 35, 7, 0, 0, 1)
```

–ë—ã–ª–∏ –ª–∏ –±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–∫–∏ *–∞–±—Å–æ–ª—é—Ç–Ω–æ —Å–ª—É—á–∞–π–Ω—ã*? –ü—Ä–∏–∑–Ω–∞–∫–æ–º —ç—Ç–æ–≥–æ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å —Ç–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ —á–∏—Å–ª–æ –±–æ–º–± –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–≤–∞–¥—Ä–∞—Ç–µ –ø–æ–¥—á–∏–Ω—è–µ—Ç—Å—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –ü—É–∞—Å—Å–æ–Ω–∞.

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä–Ω–æ –Ω–∞—à–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –ø—Ä–æ–≤–µ–¥–µ–º —Å–∏–º—É–ª—è—Ü–∏—é: –≤—ã–±–µ—Ä–µ–º $537$ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∞ $24 \times 24$ –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–∞ $1 \times 1$ –ø–æ—Å—á–∏—Ç–∞–µ–º —á–∏—Å–ª–æ –ø–æ–ø–∞–≤—à–∏—Ö —Ç—É–¥–∞ –±–æ–º–±:


```r
n = 24
point_x <- runif(537, 0, n)
point_y <- runif(537, 0, n)
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –º–Ω–æ–≥–æ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤, –≥–¥–µ –≤–æ–æ–±—â–µ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π —Ç–æ—á–∫–∏ –∏ –≥–¥–µ –≤—Å–µ–≥–æ –æ–¥–Ω–∞ —Ç–æ—á–∫–∞:


```r
#—á–∏—Å–ª–æ –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫–∞–∂–¥—ã–π –∫–≤–∞–¥—Ä–∞—Ç (–¥–ª—è –ø–æ–∫—Ä–∞—Å–∫–∏)
index <- n * floor(point_y) + floor(point_x)
index_for_table <- c(index, 0:(n ^ 2 - 1)) # —á—Ç–æ–±—ã –≤—ã–ª–æ–≤–∏—Ç—å –Ω—É–ª–∏, —Å–Ω–∏–∑—É –≤—ã—á–∏—Ç–∞–µ–º 1 –∏–∑ –≤—Å–µ–≥–æ
number_of_hits_sim <- tabulate(index_for_table + 1) - 1 # + 1 –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω—ã positive integers

#–≤–µ—Ä—à–∏–Ω—ã –∫–≤–∞–¥—Ä–∞—Ç–æ–≤
x <- c()
y <- c()

for (index in 0:(n ^ 2 - 1)) {
  x0 <- index %% n
  y0 <- index %/% n
  x = c(x, x0, x0, x0 + 1, x0 + 1)
  y = c(y, y0, y0 + 1, y0 + 1, y0)
}

d <- data.frame(x = x, y = y, 
                group = rep(0:(n ^ 2 - 1), each = 4), 
                fill = rep(as.character(number_of_hits_sim), each = 4))
```


```r
ggplot() + 
  
  geom_polygon(data = d, aes(x, y, group = group, fill = fill), 
               color = 'black', size = 0.3) + 
  
  scale_fill_brewer(palette = 'Set2') +
  
  geom_point(aes(point_x, point_y), alpha = 0.5) + 
  
  coord_fixed() + theme_void() +
  
  labs(fill = '–ß–∏—Å–ª–æ –±–æ–±–º\n–≤ –∫–≤–∞–¥—Ä–∞—Ç–µ')
```

![](–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_–º–∞—Ç—Å—Ç–∞—Ç_gh_files/figure-gfm/unnamed-chunk-21-1.png)<!-- -->

–î–ª—è —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ü–µ–Ω–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞ –∏ –Ω–∞–π–¥–µ–º —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã:


```r
freq_sim <- tabulate(c(0:7, number_of_hits_sim) + 1) - 1 # –æ–ø—è—Ç—å –ª–æ–≤–∏–º –Ω—É–ª–∏ –∏ –¥–µ–ª–∞–µ–º –ø–æ–ø—Ä–∞–≤–∫—É –∏–∑-–∑–∞ positive integers
freq_sim <- freq_sim / sum(freq_sim)
l_hat <- mean(number_of_hits_sim)
freq_pois <- dpois(number_of_hits, l_hat)
```


```r
knitr::kable(data.frame('–ß–∏—Å–ª–æ –ø–æ–ø–∞–¥–∞–Ω–∏–π' = number_of_hits,
                        '–ß–∏—Å–ª–æ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤' = freq_sim * 576,
                        '–ß–∏—Å–ª–æ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' = number_of_squares,
                        '–ù–∞–±–ª—é–¥–∞–µ–º–∞—è —á–∞—Å—Ç–æ—Ç–∞' = freq_sim,
                        '–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å' = freq_pois),
             align = 'l', digits = 3)
```



|–ß–∏—Å–ª–æ.–ø–æ–ø–∞–¥–∞–Ω–∏–π |–ß–∏—Å–ª–æ.–∫–≤–∞–¥—Ä–∞—Ç–æ–≤ |–ß–∏—Å–ª–æ.–∫–≤–∞–¥—Ä–∞—Ç–æ–≤.—Ä–µ–∞–ª—å–Ω—ã–µ.–¥–∞–Ω–Ω—ã–µ |–ù–∞–±–ª—é–¥–∞–µ–º–∞—è.—á–∞—Å—Ç–æ—Ç–∞ |–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è.–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å |
|:---------------|:---------------|:-------------------------------|:-------------------|:-------------------------|
|0               |228             |229                             |0.396               |0.394                     |
|1               |202             |211                             |0.351               |0.367                     |
|2               |109             |93                              |0.189               |0.171                     |
|3               |32              |35                              |0.056               |0.053                     |
|4               |4               |7                               |0.007               |0.012                     |
|5               |1               |0                               |0.002               |0.002                     |
|6               |0               |0                               |0.000               |0.000                     |
|7               |0               |1                               |0.000               |0.000                     |

–ò—Ç–∞–∫, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏ –ø–æ—Ö–æ–∂–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ö–æ—Ç—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ, –Ω–æ —ç—Ç–æ–≥–æ –∏ –Ω–µ —Å–ª–µ–¥–æ–≤–∞–ª–æ –æ–∂–∏–¥–∞—Ç—å). –í —Ç–æ –∂–µ –≤—Ä–µ–º—è –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã —Ö–æ—Ä–æ—à–æ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏, –ø–æ—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ü—É–∞—Å—Å–æ–Ω–æ–≤—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

## –ó–∞–¥–∞–Ω–∏–µ.

–í–∞—à–∞ –∑–∞–¥–∞—á–∞ - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø–æ—Ö–æ–∂–∏ –ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤—ã–±–æ—Ä–∫—É –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞. –î–ª—è —ç—Ç–æ–≥–æ –æ—Ü–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è $\lambda$ (–ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º) –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏, –Ω–∞–Ω–µ—Å—è –∏—Ö –Ω–∞ –æ–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫.

–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `ppois()`. –í–æ–∑–º–æ–∂–Ω–æ, —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–º –Ω–æ–º–µ—Ä–µ –Ω–µ –ø—Ä–∏–¥–µ—Ç—Å—è —Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é üòì

# –ó–∞–¥–∞—á–∞ 4. –ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –ô–µ–Ω—Å–µ–Ω–∞ –∏ –Ω–µ—Å–º–µ—â–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏.

–ü—Ä–æ–¥–æ–ª–∂–∏–º —Ä–∞–±–æ—Ç—É —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ü—É–∞—Å—Å–æ–Ω–∞. –ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –≤—ã–±–æ—Ä–∫–∞ –∏–∑ –Ω–µ–≥–æ, 
–∏ –º—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –æ—Ü–µ–Ω–∏—Ç—å $P(X=0)$. –°—Ä–∞–≤–Ω–∏–º –¥–≤–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:

- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É —Å–æ–±—ã—Ç–∏—è $\{X=0\}$ —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã.

- –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä $\lambda$, –∞ —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–∞–∫ $e^{-\lambda}$

–í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ, –æ—á–µ–≤–∏–¥–Ω–æ, —Ç–∞–∫–∞—è –æ—Ü–µ–Ω–∫–∞ –±—É–¥–µ—Ç –Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ–π (–ø–æ —Ç–æ–π –∂–µ —Å–∞–º–æ–π –ø—Ä–∏—á–∏–Ω–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —á–∞—Å—Ç–æ—Ç–∞ –≤—ã–ø–∞–¥–µ–Ω–∏—è –µ–¥–∏–Ω–∏—Ü—ã - –Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ë–µ—Ä–Ω—É–ª–ª–∏).

–ê —á—Ç–æ –∂–µ –≤–æ –≤—Ç–æ—Ä–æ–º —Å–ª—É—á–∞–µ? –ü—Ä–æ–≤–µ–¥–µ–º —Å–∏–º—É–ª—è—Ü–∏—é –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –±—É–¥–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –æ—Ü–µ–Ω–∫–∞. –ù–µ –±—É–¥–µ–º –∑–∞–±—ã–≤–∞—Ç—å, —á—Ç–æ –æ—Ü–µ–Ω–∫–∞ - —ç—Ç–æ —Å–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –∏ –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –µ–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.


```r
lambd <- 3.14
realizations <- sapply(1:1e4, function(x) {exp( -mean(rpois(n = 10, lambda = lambd)))})
```

–§—É–Ω–∫—Ü–∏—è `sapply()` –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - –ª–∏—à—å —É–¥–æ–±–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º —Ü–∏–∫–ª–∞.

–ü–æ—Å—Ç—Ä–æ–∏–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –æ—Ü–µ–Ω–∫–∏ –∏ –Ω–∞–Ω–µ—Å–µ–º –Ω–∞ –Ω–µ–µ –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ $e^{-3.14}=0.0433...$ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ `geom_vline()`:


```r
ggplot() + theme_classic() +
  geom_histogram(mapping = aes(x = realizations, y = ..density..),
                 color = 'black', fill = 'palegreen3', bins = 18, alpha = 0.8) +
  #–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
  geom_vline(xintercept = exp(-3.14), 
             linetype = 'dashed', size = 1.1, color = 'blue') + 
  
  geom_vline(xintercept = mean(realizations), 
             linetype = 'dashed', size = 1.1, color = 'red')
```

![](–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è_–º–∞—Ç—Å—Ç–∞—Ç_gh_files/figure-gfm/unnamed-chunk-25-1.png)<!-- -->

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ –∑–∞–≤—ã—à–∞–ª–∞ –∏—Å—Ç–∏–Ω–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å. –≠—Ç–æ –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ **–Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –ô–µ–Ω—Å–µ–Ω–∞**: $$\phi(\mathbb{M}(X)) \leq \mathbb{M}(\phi(X))$$
–¥–ª—è *–≤—ã–ø—É–∫–ª–æ–π* —Ñ—É–Ω–∫—Ü–∏–∏ $\phi(x)$. 

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –≤—ã–ø—É–∫–ª–∞—è —Ñ—É–Ω–∫—Ü–∏—è - —ç—Ç–æ $\phi(x)=e^{-x}$, $\mathbb{M}(X)=\lambda$, –∏ —Å–ª–µ–≤–∞ –≤ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Å—Ç–æ–∏—Ç –≤—ã–ø—É–∫–ª–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è - $e^{-\mathbb{M}(X)}$.

–ú—ã –∂–µ –ø—ã—Ç–∞–µ–º—Å—è –æ—Ü–µ–Ω–∏—Ç—å –µ–≥–æ –ø–æ–º–æ—â—å—é $e^{-\overline{X}}$, —Ö–æ—Ç—è —ç—Ç–æ (—Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–∫–æ–Ω—É –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª –∏ —Å–≤–æ–π—Å—Ç–≤–∞–º —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω) - –Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Å—Ç—Ä–æ–≥–æ –±–æ–ª—å—à–µ (–∏–∑-–∑–∞ —Å—Ç—Ä–æ–≥–æ–π –≤—ã–ø—É–∫–ª–æ—Å—Ç–∏ $e^{-x}$).

–û–¥–Ω–∞–∫–æ —Å–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —É –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –µ—Å—Ç—å –∏ —Å–≤–æ–∏ –ø–ª—é—Å—ã. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—ã–±–æ—Ä–∫—É –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ü—É–∞—Å—Å–æ–Ω–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º $\lambda = 3.14$:


```r
pois <- c(2, 2, 2, 4, 5, 2, 6, 3, 5, 1)
```

–ù–µ—Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è $P(X=0)$ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ –Ω—É–ª—é! –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å $e^{-3.14}=0.0433...$ –¥–ª—è —Ç–∞–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç $5\%$, –∏ –≤ –¥–µ—Å—è—Ç–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏—è—Ö —Å–æ–±—ã—Ç–∏–µ $\{X=0\}$ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –Ω–∏ —Ä–∞–∑—É. –°–º–µ—â–µ–Ω–Ω–∞—è –∂–µ –æ—Ü–µ–Ω–∫–∞ —Ä–∞–≤–Ω–∞:


```r
exp(-mean(pois))
```

```
## [1] 0.0407622
```

–∏ —ç—Ç–æ –≥–æ—Ä–∞–∑–¥–æ –±–ª–∏–∂–µ –∫ –∏—Å—Ç–∏–Ω–µ. –î–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–æ–ª–∂–µ–Ω –Ω–∞–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ—Å—Ç—å –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ *—Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ* –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ò–∑-–∑–∞ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ –≤–∑—è—Ç–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ—á–Ω–µ–µ.

## –ó–∞–¥–∞–Ω–∏–µ.

–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–∫–∏–µ-–Ω–∏–±—É–¥—å –∑–Ω–∞—á–µ–Ω–∏—è $\mu$ –∏ $\sigma$ –∏ *–Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ* –æ—Ü–µ–Ω–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –æ—Ü–µ–Ω–∫–∏ $$\overline{\sigma}=c_nS_n$$

–≥–¥–µ $S_n$ - –∫–æ—Ä–µ–Ω—å –∏–∑ –Ω–µ—Å–º–µ—â–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (–ø–æ –≤—ã–±–æ—Ä–∫–µ –µ–≥–æ —Å—á–∏—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è `sd()`), –∞ $$c_n=\sqrt{\frac{n-1}{2}}\frac{\Gamma(\frac{n-1}{2})}{\Gamma(\frac{n}{2})}$$

–ì–∞–º–º–∞ —Ñ—É–Ω–∫—Ü–∏—é $\Gamma(x)=\int_0^{+\infty}t^{x-1}e^{-t}dt$ –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `gamma()`.

$10000$ —Ä–∞–∑ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ—Ä–º–∞–ª—å–Ω—É—é –≤—ã–±–æ—Ä–∫—É —Ä–∞–∑–º–µ—Ä–∞ $5$ (—á—Ç–æ–±—ã —Å–º–µ—â–µ–Ω–∏–µ –±—ã–ª–æ –µ—â–µ –¥–æ–≤–æ–ª—å–Ω–æ –∑–∞–º–µ—Ç–Ω–æ) –∏ –Ω–∞ –µ–µ –æ—Å–Ω–æ–≤–µ –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –Ω–µ—Å–º–µ—â–µ–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É. –°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ —Ü–∏–∫–ª–æ–º –∏–ª–∏ —Å –ø–æ–º–æ—â—å—é `sapply()`.

–ó–∞—Ç–µ–º –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ - —Å –Ω–∞—Å—Ç–æ—è—â–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º –∏ —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∏–∑ –≤—ã–±–æ—Ä–∫–∏ –æ—Ü–µ–Ω–æ–∫.
